import telebot
from telebot import types
import json
import os
from datetime import datetime
BOT_TOKEN = "8358611518:AAHHJLP4auxuIBW8KvpzKL5smaTf7S0pHyc"
bot = telebot.TeleBot(BOT_TOKEN)
DATA_FILE = "bot_data.json"
def load_data():
    if os.path.exists(DATA_FILE):
        with open(DATA_FILE, 'r', encoding='utf-8') as f:
            data = json.load(f)
            if "weeks" not in data:
                data["weeks"] = {}
                data["current_week"] = "week_1"
                data["weeks"]["week_1"] = create_new_week()
            if "current_week" not in data:
                data["current_week"] = "week_1"
            current_week_data = data["weeks"][data["current_week"]]
            for name in current_week_data["names"]:
                if name not in current_week_data["lives"]:
                    current_week_data["lives"][name] = 3
            return data
    else:
        return {
            "weeks": {
                "week_1": create_new_week()
            },
            "current_week": "week_1"
        }
def create_new_week():
    initial_names = ["–ê–ª–µ–∫—Å–µ–π", "–ú–∞—Ä–∏—è", "–ò–≤–∞–Ω", "–ê–Ω–Ω–∞", "–î–º–∏—Ç—Ä–∏–π"]
    return {
        "names": initial_names,
        "scores": {name: ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"] for name in initial_names},
        "lives": {name: 3 for name in initial_names},
        "bonus_points": {name: 0 for name in initial_names}, 
        "created_date": datetime.now().strftime("%d.%m.%Y %H:%M")
    }
def save_data(data):
    with open(DATA_FILE, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
def get_current_week_data(data):
    return data["weeks"][data["current_week"]]
def get_lives(week_data, name):
    return week_data["lives"].get(name, 3)
def get_bonus_points(week_data, name):
    return week_data["bonus_points"].get(name, 0)
def calculate_total_score(scores, lives, bonus_points=0):
    base_score = scores.count("‚úÖ") * 10
    penalty = (3 - lives) * 50  
    total_score = base_score - penalty + bonus_points  
    return total_score
def get_week_stats(week_data):
    total_checkmarks = 0
    total_points = 0
    for name in week_data["names"]:
        scores = week_data["scores"].get(name, ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"])
        lives = get_lives(week_data, name)
        bonus_points = get_bonus_points(week_data, name)
        total_checkmarks += scores.count("‚úÖ")
        total_points += calculate_total_score(scores, lives, bonus_points)
    return total_checkmarks, total_points
def get_sorted_participants(week_data):
    participants = []
    for name in week_data["names"]:
        scores = week_data["scores"].get(name, ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"])
        lives = get_lives(week_data, name)
        bonus_points = get_bonus_points(week_data, name)
        total_score = calculate_total_score(scores, lives, bonus_points)
        participants.append({
            "name": name,
            "scores": scores,
            "lives": lives,
            "bonus_points": bonus_points,
            "total_score": total_score
        })
    participants.sort(key=lambda x: x["total_score"], reverse=True)
    return participants
def main_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    btn1 = types.KeyboardButton("üìä –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫–∏")
    btn2 = types.KeyboardButton("üë• –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤")
    btn3 = types.KeyboardButton("‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏")
    btn4 = types.KeyboardButton("üíî –°–Ω—è—Ç—å –∂–∏–∑–Ω—å")
    btn5 = types.KeyboardButton("‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã")
    btn6 = types.KeyboardButton("üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏")
    btn7 = types.KeyboardButton("‚ùì –ü–æ–º–æ—â—å")
    markup.add(btn1, btn2, btn3, btn4, btn5, btn6, btn7)
    return markup
def weeks_menu(data):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    for week_key in data["weeks"]:
        week_number = week_key.replace("week_", "")
        is_current = " ‚úÖ" if week_key == data["current_week"] else ""
        markup.add(types.KeyboardButton(f"üìÖ –ù–µ–¥–µ–ª—è {week_number}{is_current}"))
    markup.add(types.KeyboardButton("üÜï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –Ω–µ–¥–µ–ª—é"))
    markup.add(types.KeyboardButton("üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –Ω–µ–¥–µ–ª—é"))
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥"))
    return markup
def lives_menu(names):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    for name in names:
        markup.add(types.KeyboardButton(f"üíî {name}"))
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥"))
    return markup
def bonus_points_menu(names):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    for name in names:
        markup.add(types.KeyboardButton(f"‚ûï {name}"))
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥"))
    return markup
def scores_menu(names):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    for name in names:
        markup.add(types.KeyboardButton(f"üìù {name}"))
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥"))
    return markup
def emoji_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=5)
    for i in range(5):
        buttons = [types.KeyboardButton(f"{i+1}:‚úÖ"), types.KeyboardButton(f"{i+1}:‚ùå")]
        markup.add(*buttons)
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É"))
    return markup

@bot.message_handler(commands=['start'])
def send_welcome(message):
    data = load_data()
    welcome_text = """üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç –¥–ª—è —É—á–µ—Ç–∞ –æ—Ü–µ–Ω–æ–∫
üìä **–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫–∏** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
üë• **–ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤** - –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
‚úÖ **–ò–∑–º–µ–Ω—è—Ç—å –æ—Ü–µ–Ω–∫–∏** - –∏–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
üíî **–°–Ω—è—Ç—å –∂–∏–∑–Ω—å** - —Å–Ω—è—Ç—å –∂–∏–∑–Ω—å (-50 –æ—á–∫–æ–≤)
‚ûï **–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã** - –¥–æ–±–∞–≤–∏—Ç—å –±–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã
üìÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏** - —Å–æ–∑–¥–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å –Ω–µ–¥–µ–ª–∏
‚ùì **–ü–æ–º–æ—â—å** - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
üéØ –£ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ 3 –∂–∏–∑–Ω–∏. –ó–∞ –∫–∞–∂–¥—É—é —Å–Ω—è—Ç—É—é –∂–∏–∑–Ω—å —Å–Ω–∏–º–∞–µ—Ç—Å—è 50 –æ—á–∫–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º!"""
    bot.send_message(message.chat.id, welcome_text, 
                    reply_markup=main_menu(), parse_mode='Markdown')
@bot.message_handler(func=lambda message: message.text == "‚ùì –ü–æ–º–æ—â—å")
def send_help(message):
    help_text = """üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
üìä **–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫–∏** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
üë• **–ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:
   - –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º
   - –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è: –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å –∏–º–µ–Ω–µ–º
‚úÖ **–ò–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:
   - –í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
   - –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è (1-5)
   - –í—ã–±–µ—Ä–∏—Ç–µ —Å–º–∞–π–ª–∏–∫ (‚úÖ –∏–ª–∏ ‚ùå)
üíî **–°–Ω—è—Ç—å –∂–∏–∑–Ω—å** - —Å–Ω—è—Ç—å –æ–¥–Ω—É –∂–∏–∑–Ω—å —É —É—á–∞—Å—Ç–Ω–∏–∫–∞:
   - –®—Ç—Ä–∞—Ñ -50 –æ—á–∫–æ–≤ –∑–∞ –∫–∞–∂–¥—É—é —Å–Ω—è—Ç—É—é –∂–∏–∑–Ω—å
‚ûï **–î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã** - –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ —Å–Ω—è—Ç—å –±–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã —É—á–∞—Å—Ç–Ω–∏–∫—É:
   - –ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
   - –ü—Ä–∏–º–µ—Ä: +10 –¥–æ–±–∞–≤–∏—Ç 10 –±–∞–ª–ª–æ–≤, -5 —Å–Ω–∏–º–µ—Ç 5 –±–∞–ª–ª–æ–≤
üìÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏** - —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ–¥–µ–ª—è–º–∏:
   - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –Ω–µ–¥–µ–ª—é (—Å–±—Ä–æ—Å –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö)
   - –£–¥–∞–ª–∏—Ç—å –Ω–µ–¥–µ–ª—é
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É –Ω–µ–¥–µ–ª—è–º–∏
üîô **–ù–∞–∑–∞–¥** - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
üéØ **–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á–µ—Ç–∞:**
   - –£ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ 3 –∂–∏–∑–Ω–∏ –≤ –Ω–∞—á–∞–ª–µ –Ω–µ–¥–µ–ª–∏
   - –ö–∞–∂–¥–∞—è ‚úÖ = 10 –æ—á–∫–æ–≤
   - –ö–∞–∂–¥–∞—è —Å–Ω—è—Ç–∞—è –∂–∏–∑–Ω—å = -50 –æ—á–∫–æ–≤
   - –ë–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è/–≤—ã—á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –æ–±—â–µ–≥–æ —Å—á–µ—Ç–∞
   - –û–±—â–∏–π —Å—á–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—á–∫–æ–≤"""
    bot.send_message(message.chat.id, help_text, parse_mode='Markdown')
@bot.message_handler(func=lambda message: message.text == "üìä –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫–∏")
def show_scores(message):
    data = load_data()
    week_data = get_current_week_data(data)
    participants = get_sorted_participants(week_data)
    total_checkmarks, total_points = get_week_stats(week_data)
    week_number = data["current_week"].replace("week_", "")
    message_text = f"üéØ *–¢–µ–∫—É—â–∏–µ –æ—Ü–µ–Ω–∫–∏ (–ù–µ–¥–µ–ª—è {week_number}):*\n\n"
    for i, participant in enumerate(participants, 1):
        name = participant["name"]
        scores = participant["scores"]
        lives = participant["lives"]
        bonus_points = participant["bonus_points"]
        total_score = participant["total_score"]
        score_display = " ".join(scores)
        hearts = "‚ù§Ô∏è" * lives + "‚ô°" * (3 - lives)
        message_text += f"{i}. *{name}*\n"
        message_text += f"   –û—Ü–µ–Ω–∫–∏: {score_display}\n"
        message_text += f"   –ñ–∏–∑–Ω–∏: {hearts} ({lives}/3)\n"
        if bonus_points != 0:
            bonus_sign = "+" if bonus_points > 0 else ""
            message_text += f"   –ë–æ–Ω—É—Å—ã: {bonus_sign}{bonus_points} –±–∞–ª–ª–æ–≤\n"
        score_display = str(total_score) if total_score >= 0 else f"-{abs(total_score)}"
        message_text += f"   –û—á–∫–∏: *{score_display}*\n\n"
    
    message_text += f"üìà *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–µ–ª–∏:*\n"
    message_text += f"‚Ä¢ –í—Å–µ–≥–æ ‚úÖ: {total_checkmarks}\n"
    total_points_display = str(total_points) if total_points >= 0 else f"-{abs(total_points)}"
    message_text += f"‚Ä¢ –í—Å–µ–≥–æ –æ—á–∫–æ–≤: {total_points_display}\n"
    message_text += f"‚Ä¢ –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {len(participants)}"
    
    bot.send_message(message.chat.id, message_text, parse_mode='Markdown')

@bot.message_handler(func=lambda message: message.text == "üíî –°–Ω—è—Ç—å –∂–∏–∑–Ω—å")
def remove_life_menu(message):
    data = load_data()
    week_data = get_current_week_data(data)
    
    if not week_data["names"]:
        bot.send_message(message.chat.id, "‚ùå –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—É—Å—Ç! –î–æ–±–∞–≤—å—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –º–µ–Ω—é '–ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤'")
        return
    
    text = "üíî *–°–Ω—è—Ç–∏–µ –∂–∏–∑–Ω–∏:*\n\n"
    text += "–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ —Å–Ω—è—Ç—å –∂–∏–∑–Ω—å:\n"
    text += "‚ö†Ô∏è *–í–Ω–∏–º–∞–Ω–∏–µ:* –∑–∞ –∫–∞–∂–¥—É—é —Å–Ω—è—Ç—É—é –∂–∏–∑–Ω—å —Å–Ω–∏–º–∞–µ—Ç—Å—è 50 –æ—á–∫–æ–≤!\n\n"
    
    participants = get_sorted_participants(week_data)
    for i, participant in enumerate(participants, 1):
        text += f"{i}. {participant['name']} - {participant['lives']}/3 –∂–∏–∑–Ω–µ–π\n"
    
    bot.send_message(message.chat.id, text, 
                    reply_markup=lives_menu(week_data["names"]), parse_mode='Markdown')
    bot.register_next_step_handler(message, process_life_removal)

def process_life_removal(message):
    if message.text == "üîô –ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())
        return
    if not message.text.startswith("üíî "):
        bot.send_message(message.chat.id, "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–Ω–æ–ø–æ–∫!")
        remove_life_menu(message)
        return
    
    data = load_data()
    week_data = get_current_week_data(data)
    selected_name = message.text.replace("üíî ", "")
    
    if selected_name in week_data["names"]:
        current_lives = get_lives(week_data, selected_name)
        
        if current_lives > 0:
            week_data["lives"][selected_name] = current_lives - 1
            save_data(data)
            scores = week_data["scores"].get(selected_name, ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"])
            new_lives = get_lives(week_data, selected_name)
            bonus_points = get_bonus_points(week_data, selected_name)
            new_score = calculate_total_score(scores, new_lives, bonus_points)
            
            text = f"üíî –£ —É—á–∞—Å—Ç–Ω–∏–∫–∞ *{selected_name}* —Å–Ω—è—Ç–∞ 1 –∂–∏–∑–Ω—å!\n\n"
            text += f"‚Ä¢ –ë—ã–ª–æ –∂–∏–∑–Ω–µ–π: {current_lives}/3\n"
            text += f"‚Ä¢ –°—Ç–∞–ª–æ –∂–∏–∑–Ω–µ–π: {new_lives}/3\n"
            text += f"‚Ä¢ –®—Ç—Ä–∞—Ñ: -50 –æ—á–∫–æ–≤\n"
            score_display = str(new_score) if new_score >= 0 else f"-{abs(new_score)}"
            text += f"‚Ä¢ –¢–µ–∫—É—â–∏–µ –æ—á–∫–∏: *{score_display}*\n\n"
            
            if new_lives == 0:
                text += "‚ö†Ô∏è *–í–Ω–∏–º–∞–Ω–∏–µ:* –£ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å –∂–∏–∑–Ω–µ–π!"
            
            bot.send_message(message.chat.id, text, parse_mode='Markdown')
        else:
            bot.send_message(message.chat.id, 
                           f"‚ùå –£ —É—á–∞—Å—Ç–Ω–∏–∫–∞ *{selected_name}* —É–∂–µ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å –∂–∏–∑–Ω–µ–π!", 
                           parse_mode='Markdown')
    else:
        bot.send_message(message.chat.id, "‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!")
    
    remove_life_menu(message)

@bot.message_handler(func=lambda message: message.text == "‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã")
def add_bonus_points_menu(message):
    data = load_data()
    week_data = get_current_week_data(data)
    
    if not week_data["names"]:
        bot.send_message(message.chat.id, "‚ùå –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—É—Å—Ç! –î–æ–±–∞–≤—å—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –º–µ–Ω—é '–ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤'")
        return
    
    text = "‚ûï *–î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—Å–Ω—è—Ç–∏–µ –±–∞–ª–ª–æ–≤:*\n\n"
    text += "–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞:\n"
    text += "‚ÑπÔ∏è –ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞\n\n"
    
    participants = get_sorted_participants(week_data)
    for i, participant in enumerate(participants, 1):
        current_bonus = participant["bonus_points"]
        bonus_text = f" ({current_bonus:+})" if current_bonus != 0 else ""
        text += f"{i}. {participant['name']}{bonus_text}\n"
    
    bot.send_message(message.chat.id, text, 
                    reply_markup=bonus_points_menu(week_data["names"]), parse_mode='Markdown')
    bot.register_next_step_handler(message, select_person_for_bonus)

def select_person_for_bonus(message):
    if message.text == "üîô –ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())
        return
    if not message.text.startswith("‚ûï "):
        bot.send_message(message.chat.id, "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–Ω–æ–ø–æ–∫!")
        add_bonus_points_menu(message)
        return
    
    data = load_data()
    week_data = get_current_week_data(data)
    selected_name = message.text.replace("‚ûï ", "")
    
    if selected_name in week_data["names"]:
        bot.send_message(message.chat.id, 
                        f"–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫—É *{selected_name}*:\n(–º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞)",
                        parse_mode='Markdown',
                        reply_markup=types.ReplyKeyboardRemove())
        bot.register_next_step_handler(message, process_bonus_points, selected_name)
    else:
        bot.send_message(message.chat.id, "‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        add_bonus_points_menu(message)

def process_bonus_points(message, selected_name):
    try:
        points = int(message.text.strip())  
        data = load_data()
        week_data = get_current_week_data(data)
        current_bonus = get_bonus_points(week_data, selected_name)
        week_data["bonus_points"][selected_name] = current_bonus + points
        save_data(data)
        scores = week_data["scores"].get(selected_name, ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"])
        lives = get_lives(week_data, selected_name)
        new_total_score = calculate_total_score(scores, lives, current_bonus + points)
        
        text = f"‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫—É *{selected_name}* "
        if points >= 0:
            text += f"–¥–æ–±–∞–≤–ª–µ–Ω–æ *+{points}* –±–∞–ª–ª–æ–≤!\n\n"
        else:
            text += f"—Å–Ω—è—Ç–æ *{points}* –±–∞–ª–ª–æ–≤!\n\n"
        
        text += f"‚Ä¢ –ë—ã–ª–æ –±–æ–Ω—É—Å–Ω—ã—Ö –±–∞–ª–ª–æ–≤: {current_bonus}\n"
        text += f"‚Ä¢ –°—Ç–∞–ª–æ –±–æ–Ω—É—Å–Ω—ã—Ö –±–∞–ª–ª–æ–≤: {current_bonus + points}\n"
        total_score_display = str(new_total_score) if new_total_score >= 0 else f"-{abs(new_total_score)}"
        text += f"‚Ä¢ –û–±—â–∏–π —Å—á–µ—Ç: *{total_score_display}*"
        
        bot.send_message(message.chat.id, text, parse_mode='Markdown')
        add_bonus_points_menu(message)
        
    except ValueError:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        add_bonus_points_menu(message)

@bot.message_handler(func=lambda message: message.text == "üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏")
def manage_weeks(message):
    data = load_data()
    
    text = "üìÖ *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏:*\n\n"
    text += "‚úÖ - —Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è\n\n"
    
    for week_key in data["weeks"]:
        week_number = week_key.replace("week_", "")
        week_data = data["weeks"][week_key]
        is_current = " ‚úÖ" if week_key == data["current_week"] else ""
        total_checkmarks, total_points = get_week_stats(week_data)
        
        text += f"*–ù–µ–¥–µ–ª—è {week_number}*{is_current}\n"
        text += f"–°–æ–∑–¥–∞–Ω–∞: {week_data['created_date']}\n"
        text += f"–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {len(week_data['names'])}\n"
        text += f"‚úÖ: {total_checkmarks} | –û—á–∫–∏: {total_points}\n\n"
    
    bot.send_message(message.chat.id, text, 
                    reply_markup=weeks_menu(data), parse_mode='Markdown')
    bot.register_next_step_handler(message, process_weeks_management)

def process_weeks_management(message):
    if message.text == "üîô –ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())
        return
    
    elif message.text == "üÜï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –Ω–µ–¥–µ–ª—é":
        data = load_data()
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –Ω–µ–¥–µ–ª—é
        new_week_number = len(data["weeks"]) + 1
        new_week_key = f"week_{new_week_number}"
        data["weeks"][new_week_key] = create_new_week()
        data["current_week"] = new_week_key
        save_data(data)
        
        bot.send_message(message.chat.id, 
                        f"‚úÖ –°–æ–∑–¥–∞–Ω–∞ *–ù–µ–¥–µ–ª—è {new_week_number}*!\n–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã, –∂–∏–∑–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.",
                        parse_mode='Markdown')
        manage_weeks(message)
        return
    
    elif message.text == "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –Ω–µ–¥–µ–ª—é":
        data = load_data()
        
        if len(data["weeks"]) <= 1:
            bot.send_message(message.chat.id, "‚ùå –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é!")
            manage_weeks(message)
            return
        
        text = "üóëÔ∏è *–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:*\n\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–¥–µ–ª—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:\n\n"
        
        for week_key in data["weeks"]:
            week_number = week_key.replace("week_", "")
            week_data = data["weeks"][week_key]
            total_checkmarks, total_points = get_week_stats(week_data)
            
            text += f"*–ù–µ–¥–µ–ª—è {week_number}*\n"
            text += f"‚úÖ: {total_checkmarks} | –û—á–∫–∏: {total_points}\n\n"
        
        bot.send_message(message.chat.id, text, parse_mode='Markdown')
        bot.register_next_step_handler(message, process_week_deletion)
        return
    
    elif message.text.startswith("üìÖ –ù–µ–¥–µ–ª—è "):
        data = load_data()
        week_number = message.text.replace("üìÖ –ù–µ–¥–µ–ª—è ", "").replace(" ‚úÖ", "").strip()
        week_key = f"week_{week_number}"
        
        if week_key in data["weeks"]:
            data["current_week"] = week_key
            save_data(data)
            bot.send_message(message.chat.id, f"‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ *–ù–µ–¥–µ–ª—è {week_number}*", parse_mode='Markdown')
        else:
            bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
        
        manage_weeks(message)
        return
    
    else:
        bot.send_message(message.chat.id, "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞!")
        manage_weeks(message)

def process_week_deletion(message):
    if message.text == "üîô –ù–∞–∑–∞–¥":
        manage_weeks(message)
        return
    
    data = load_data()
    
    try:
        week_number = message.text.replace("–ù–µ–¥–µ–ª—è ", "").strip()
        week_key = f"week_{week_number}"
        
        if week_key in data["weeks"]:
            if len(data["weeks"]) <= 1:
                bot.send_message(message.chat.id, "‚ùå –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é!")
                manage_weeks(message)
                return
            

            del data["weeks"][week_key]
            if data["current_week"] == week_key:
                data["current_week"] = list(data["weeks"].keys())[0]
            
            save_data(data)
            bot.send_message(message.chat.id, f"‚úÖ –ù–µ–¥–µ–ª—è {week_number} —É–¥–∞–ª–µ–Ω–∞!", parse_mode='Markdown')
        else:
            bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
    
    except:
        bot.send_message(message.chat.id, "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –Ω–µ–¥–µ–ª–∏!")
    
    manage_weeks(message)

@bot.message_handler(func=lambda message: message.text == "üë• –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤")
def edit_composition(message):
    data = load_data()
    week_data = get_current_week_data(data)
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    for name in week_data["names"]:
        markup.add(types.KeyboardButton(f"‚ùå –£–¥–∞–ª–∏—Ç—å {name}"))
    
    markup.add(types.KeyboardButton("‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ"))
    markup.add(types.KeyboardButton("üîô –ù–∞–∑–∞–¥"))
    
    week_number = data["current_week"].replace("week_", "")
    text = f"üë• *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–æ–º (–ù–µ–¥–µ–ª—è {week_number}):*\n\n"
    text += "‚Ä¢ –î–ª—è *–¥–æ–±–∞–≤–ª–µ–Ω–∏—è*: –Ω–∞–∂–º–∏—Ç–µ '‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ' –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–º—è\n"
    text += "‚Ä¢ –î–ª—è *—É–¥–∞–ª–µ–Ω–∏—è*: –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å –∏–º–µ–Ω–µ–º\n"
    text += "‚Ä¢ *–ù–æ–≤—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏* –ø–æ–ª—É—á–∞—é—Ç 3 –∂–∏–∑–Ω–∏\n"
    text += "‚Ä¢ –¢–µ–∫—É—â–∏–π —Å–æ—Å—Ç–∞–≤:\n"
    
    participants = get_sorted_participants(week_data)
    for i, participant in enumerate(participants, 1):
        text += f"  {i}. {participant['name']} - {participant['lives']}/3 –∂–∏–∑–Ω–µ–π\n"
    
    bot.send_message(message.chat.id, text, reply_markup=markup, parse_mode='Markdown')
    bot.register_next_step_handler(message, process_composition_edit)

def process_composition_edit(message):
    data = load_data()
    week_data = get_current_week_data(data)
    
    if message.text == "üîô –ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())
        return
    
    elif message.text == "‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ":
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –Ω–æ–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞:", 
                        reply_markup=types.ReplyKeyboardRemove())
        bot.register_next_step_handler(message, add_new_member)
        return
    
    elif message.text.startswith("‚ùå –£–¥–∞–ª–∏—Ç—å "):
        name_to_remove = message.text.replace("‚ùå –£–¥–∞–ª–∏—Ç—å ", "")
        if name_to_remove in week_data["names"]:
            week_data["names"].remove(name_to_remove)
            if name_to_remove in week_data["scores"]:
                del week_data["scores"][name_to_remove]
            if name_to_remove in week_data["lives"]:
                del week_data["lives"][name_to_remove]
            if name_to_remove in week_data["bonus_points"]:
                del week_data["bonus_points"][name_to_remove]
            save_data(data)
            bot.send_message(message.chat.id, f"‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫ {name_to_remove} —É–¥–∞–ª–µ–Ω!")
        else:
            bot.send_message(message.chat.id, "‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!")
    
    edit_composition(message)

def add_new_member(message):
    data = load_data()
    week_data = get_current_week_data(data)
    new_name = message.text.strip()
    
    if not new_name:
        bot.send_message(message.chat.id, "‚ùå –ò–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!")
    elif new_name in week_data["names"]:
        bot.send_message(message.chat.id, "‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!")
    else:
        week_data["names"].append(new_name)
        week_data["scores"][new_name] = ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"]
        week_data["lives"][new_name] = 3  
        week_data["bonus_points"][new_name] = 0  
        save_data(data)
        bot.send_message(message.chat.id, f"‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫ {new_name} –¥–æ–±–∞–≤–ª–µ–Ω —Å 3 –∂–∏–∑–Ω—è–º–∏!")
    
    edit_composition(message)

@bot.message_handler(func=lambda message: message.text == "‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏")
def edit_scores(message):
    data = load_data()
    week_data = get_current_week_data(data)
    
    if not week_data["names"]:
        bot.send_message(message.chat.id, "‚ùå –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—É—Å—Ç! –î–æ–±–∞–≤—å—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ –º–µ–Ω—é '–ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤'")
        return
    
    week_number = data["current_week"].replace("week_", "")
    text = f"‚úÖ *–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ (–ù–µ–¥–µ–ª—è {week_number}):*\n\n–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫:"
    bot.send_message(message.chat.id, text, 
                    reply_markup=scores_menu(week_data["names"]), parse_mode='Markdown')
    bot.register_next_step_handler(message, select_person_for_editing)

def select_person_for_editing(message):
    if message.text == "üîô –ù–∞–∑–∞–¥":
        bot.send_message(message.chat.id, "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())
        return
    if not message.text.startswith("üìù "):
        bot.send_message(message.chat.id, "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–Ω–æ–ø–æ–∫!")
        edit_scores(message)
        return
    
    data = load_data()
    week_data = get_current_week_data(data)
    selected_name = message.text.replace("üìù ", "")
    
    if selected_name in week_data["names"]:
        scores = week_data["scores"].get(selected_name, ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"])
        lives = get_lives(week_data, selected_name)
        bonus_points = get_bonus_points(week_data, selected_name)
        current_score = calculate_total_score(scores, lives, bonus_points)
        
        score_display = " ".join([f"{i+1}" for i in range(5)])
        emoji_display = " ".join(scores)
        
        text = f"üìù *–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –¥–ª—è {selected_name}:*\n\n"
        text += f"–ù–æ–º–µ—Ä–∞:    {score_display}\n"
        text += f"–û—Ü–µ–Ω–∫–∏:  {emoji_display}\n"
        current_score_display = str(current_score) if current_score >= 0 else f"-{abs(current_score)}"
        text += f"–ñ–∏–∑–Ω–∏: {lives}/3 | –ë–æ–Ω—É—Å—ã: +{bonus_points} | –û—á–∫–∏: {current_score_display}\n\n"
        text += "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è (1-5):"
        
        bot.send_message(message.chat.id, text, 
                        reply_markup=emoji_menu(), parse_mode='Markdown')
        bot.register_next_step_handler(message, select_score_to_change, selected_name)
    else:
        bot.send_message(message.chat.id, "‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        edit_scores(message)

def select_score_to_change(message, selected_name):
    if message.text == "üîô –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É":
        edit_scores(message)
        return
    
    data = load_data()
    week_data = get_current_week_data(data)
    
    try:
        if ":" in message.text:
            score_num = int(message.text.split(":")[0]) - 1
            new_emoji = "‚úÖ" if "‚úÖ" in message.text else "‚ùå"
            
            if 0 <= score_num <= 4:
                if selected_name not in week_data["scores"]:
                    week_data["scores"][selected_name] = ["‚ùå", "‚ùå", "‚ùå", "‚ùå", "‚ùå"]
                
                week_data["scores"][selected_name][score_num] = new_emoji
                save_data(data)
                
                scores = week_data["scores"][selected_name]
                lives = get_lives(week_data, selected_name)
                bonus_points = get_bonus_points(week_data, selected_name)
                new_score = calculate_total_score(scores, lives, bonus_points)
                
                score_display = " ".join([f"{i+1}" for i in range(5)])
                emoji_display = " ".join(scores)
                
                text = f"‚úÖ –û—Ü–µ–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!\n\n"
                text += f"*{selected_name}:*\n"
                text += f"–ù–æ–º–µ—Ä–∞:    {score_display}\n"
                text += f"–û—Ü–µ–Ω–∫–∏:  {emoji_display}\n"
        
                new_score_display = str(new_score) if new_score >= 0 else f"-{abs(new_score)}"
                text += f"–ñ–∏–∑–Ω–∏: {lives}/3 | –ë–æ–Ω—É—Å—ã: +{bonus_points} | –û—á–∫–∏: {new_score_display}\n\n"
                text += "–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –æ—Ü–µ–Ω–∫—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–ª–∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞–∑–∞–¥:"
                
                bot.send_message(message.chat.id, text, 
                                reply_markup=emoji_menu(), parse_mode='Markdown')
                bot.register_next_step_handler(message, select_score_to_change, selected_name)
            else:
                bot.send_message(message.chat.id, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä –æ—Ü–µ–Ω–∫–∏! –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç 1 –¥–æ 5.")
                select_person_for_editing(message)
    except ValueError:
        bot.send_message(message.chat.id, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏.")
        select_person_for_editing(message)


@bot.message_handler(content_types=['text'])
def handle_text(message):
    main_menu_buttons = ["üìä –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ü–µ–Ω–∫–∏", "üë• –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤", "‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫–∏", 
                        "üíî –°–Ω—è—Ç—å –∂–∏–∑–Ω—å", "‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã", "üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è–º–∏", "‚ùì –ü–æ–º–æ—â—å"]
    
    if message.text not in main_menu_buttons:
        bot.send_message(message.chat.id, 
                        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º:",
                        reply_markup=main_menu())


bot.remove_webhook()

bot.polling()
